{
  "type": "object",
  "id": "urn:jsonschema:io:gravitee:am:tokengranter:jwtbearer:JwtBearerTokenGranterConfiguration",
  "description": "RFC 7523, Section 2.1, Using JWTs as a means for requesting an OAuth 2.0 access token.\nThe following example demonstrates an access token request with a JWT as an authorization grant :\n\nPOST /token HTTP/1.1\ngrant_type=urn:ietf:params:oauth:grant-type:jwt-bearer&assertion=|signed-JWT-token|",
  "properties": {
    "grantType": {
      "title": "Grant Type",
      "description": "OAuth 2.0 grant type. The client uses an extension grant type by specifying the grant type value of the \"grant_type\" parameter of the token endpoint.",
      "default": "urn:ietf:params:oauth:grant-type:jwt-bearer",
      "readOnly": true
    },
    "publicKeyResolver": {
      "title": "Public Key resolver",
      "description": "Define how token (JWT) will be verify",
      "type": "string",
      "default": "GIVEN_KEY",
      "enum": [
        "GIVEN_KEY",
        "JWKS_URL"
      ],
      "x-schema-form": {
        "type": "select",
        "titleMap": {
          "GIVEN_KEY": "GIVEN_KEY: You must provide a signature key (PEM format or SSH key format [ssh-rsa, ecdsa, ssh-dsa])",
          "JWKS_URL": "JWKS_URL: Retrieve JWKS from URL (Basically, URL ending with '/.well-known/jwks.json')"
        }
      }
    },
    "publicKey": {
      "title": "Resolver parameter",
      "description": "Set the signature key <i><b>(GIVEN_KEY)</b></i> or a JWKS URL <i><b>(JWKS_URL)</b></i> following selected resolver. If selected <i><b>(GIVEN_KEY)</b></i>, must start with key type (e.g. ssh-rsa).",
      "type": "string",
      "widget": "textarea"
    },
    "claimsMapper": {
      "title": "Claims mapper",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "assertion_claim": {
            "title": "Assertion claim",
            "description": "Assertion payload claim",
            "type": "string"
          },
          "token_claim": {
            "title": "Token claim",
            "description": "Claim that will be added to End-User claims",
            "type": "string"
          }
        }
      }
    }
  },
  "required": [
    "publicKeyResolver",
    "publicKey"
  ]
}
