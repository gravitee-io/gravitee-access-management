<!--

    Copyright (C) 2015 The Gravitee team (http://gravitee.io)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<div class="gv-page-container">
  <a (click)="goBackToCredentials()" class="gv-back-link"><small><< Back to credentials</small></a>
  <h1 *ngIf="isCertificate()">Certificate credential</h1>
  <h1 *ngIf="isWebAuthn()">WebAuthn credential</h1>
  <div class="audit-content" fxLayout="row">
    <form fxLayout="column" fxFlex="70">
      <div class="gv-form-section">
        <div class="gv-form-section-title" *ngIf="isWebAuthn() && credential.deviceName">
          <h5>Device Information</h5>
          <small>Device name associated with this credential</small>
          <mat-divider></mat-divider>
        </div>
        <mat-form-field *ngIf="isWebAuthn() && credential.deviceName" appearance="outline" floatLabel="always">
          <mat-label>Device Name</mat-label>
          <input matInput placeholder="Device name" disabled [value]="credential.deviceName" />
          <mat-hint>Device name</mat-hint>
        </mat-form-field>

        <!-- Certificate-specific fields -->
        <div class="gv-form-section-title" *ngIf="isCertificate()">
          <h5>Certificate Information</h5>
          <small>Certificate details and properties</small>
          <mat-divider></mat-divider>
        </div>
        <mat-form-field *ngIf="isCertificate() && credential.certificateSubjectDN" appearance="outline" floatLabel="always">
          <mat-label>Subject Distinguished Name</mat-label>
          <input matInput placeholder="Subject DN" disabled [value]="credential.certificateSubjectDN" />
          <mat-hint>Certificate Subject DN</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isCertificate() && credential.certificateThumbprint" appearance="outline" floatLabel="always">
          <mat-label>Certificate Thumbprint</mat-label>
          <input matInput placeholder="Thumbprint" disabled [value]="credential.certificateThumbprint" class="monospace" />
          <mat-hint>SHA-256 thumbprint of the certificate</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isCertificate() && credential.certificateSerialNumber" appearance="outline" floatLabel="always">
          <mat-label>Serial Number</mat-label>
          <input matInput placeholder="Serial Number" disabled [value]="credential.certificateSerialNumber" class="monospace" />
          <mat-hint>Certificate serial number from CA</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isCertificate() && credential.certificateExpiresAt" appearance="outline" floatLabel="always">
          <mat-label>Expires At</mat-label>
          <input matInput placeholder="Expiration" disabled [value]="credential.certificateExpiresAt | date: 'dd/MM/yyyy HH:mm:ss.sss'" />
          <mat-hint>Certificate expiration date</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isCertificate() && credential.certificatePem" appearance="outline" floatLabel="always">
          <mat-label>Certificate (PEM)</mat-label>
          <textarea
            matInput
            placeholder="PEM Certificate"
            disabled
            rows="10"
            [value]="credential.certificatePem"
            class="monospace"
          ></textarea>
          <mat-hint>PEM-encoded certificate public key</mat-hint>
        </mat-form-field>

        <!-- WebAuthn-specific fields -->
        <div class="gv-form-section-title" *ngIf="isWebAuthn()">
          <h5>WebAuthn Information</h5>
          <small>WebAuthn credential details and properties</small>
          <mat-divider></mat-divider>
        </div>
        <mat-form-field *ngIf="isWebAuthn() && credential.credentialId" appearance="outline" floatLabel="always">
          <mat-label>Credential ID</mat-label>
          <input matInput placeholder="CredentialId" disabled [value]="credential.credentialId" />
          <mat-hint>Credential ID</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isWebAuthn() && credential.publicKey" appearance="outline" floatLabel="always">
          <mat-label>Public key</mat-label>
          <input matInput placeholder="Public Key" disabled [value]="credential.publicKey" />
          <mat-hint>Credential public key</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isWebAuthn() && credential.aaguid" appearance="outline" floatLabel="always">
          <mat-label>Authenticator Attestation Identifier</mat-label>
          <input matInput placeholder="Authenticator Attestation Identifier" disabled [value]="credential.aaguid" />
          <mat-hint>Authenticator Attestation Identifier</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isWebAuthn() && credential.attestationStatementFormat" appearance="outline" floatLabel="always">
          <mat-label>Attestation Statement Format</mat-label>
          <input matInput placeholder="Attestation Statement Format" disabled [value]="credential.attestationStatementFormat" />
          <mat-hint>Attestation Statement Format</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="isWebAuthn() && credential.lastCheckedAt" appearance="outline" floatLabel="always">
          <mat-label>Last checked at</mat-label>
          <input matInput placeholder="Actor" disabled [value]="credential.lastCheckedAt | date: 'dd/MM/yyyy HH:mm:ss.sss'" />
          <mat-hint>Last time the credential has been checked</mat-hint>
        </mat-form-field>

        <!-- Common fields (both types) -->
        <div
          class="gv-form-section-title"
          *ngIf="credential.createdAt || credential.accessedAt || credential.ipAddress || credential.userAgent"
        >
          <h5>Usage Information</h5>
          <small>Credential usage and access details</small>
          <mat-divider></mat-divider>
        </div>
        <mat-form-field *ngIf="credential.createdAt" appearance="outline" floatLabel="always">
          <mat-label>Created at</mat-label>
          <input matInput placeholder="Actor" disabled [value]="credential.createdAt | date: 'dd/MM/yyyy HH:mm:ss.sss'" />
          <mat-hint>Credential creation time</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="credential.accessedAt" appearance="outline" floatLabel="always">
          <mat-label>Accessed at</mat-label>
          <input matInput placeholder="Actor" disabled [value]="credential.accessedAt | date: 'dd/MM/yyyy HH:mm:ss.sss'" />
          <mat-hint>Time of last access with this credential</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="credential.ipAddress" appearance="outline" floatLabel="always">
          <mat-label>IP Address</mat-label>
          <input matInput placeholder="IP Address" disabled [value]="credential.ipAddress" />
          <mat-hint>IP address of last access with this credential</mat-hint>
        </mat-form-field>
        <mat-form-field *ngIf="credential.userAgent" appearance="outline" floatLabel="always">
          <mat-label>User Agent</mat-label>
          <input matInput placeholder="User Agent" disabled [value]="credential.userAgent" />
          <mat-hint>User agent of last access with this credential</mat-hint>
        </mat-form-field>
      </div>
    </form>
    <div class="gv-page-description" fxFlex>
      <h3 *ngIf="isCertificate()">Certificate credential</h3>
      <h3 *ngIf="isWebAuthn()">WebAuthn credential</h3>
      <div class="gv-page-description-content">
        <p *ngIf="isCertificate()">View the detailed properties of the certificate credential.</p>
        <p *ngIf="isWebAuthn()">View the detailed properties of the WebAuthn credential.</p>
      </div>
    </div>
  </div>
</div>
