<!--

    Copyright (C) 2015 The Gravitee team (http://gravitee.io)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<div>
  <div>
    <div fxFlex="70">
      <form (ngSubmit)="update()" (keydown.enter)="false" fxLayout="column" #applicationForm="ngForm">
        <div *ngIf="editMode">

          <div fxLayout="column" class="gv-form-section">
            <mat-slide-toggle [checked]="inherited" (change)="setInheritConfigurationValue($event);formChange()">
              Inherit configuration
            </mat-slide-toggle>
            <mat-hint style="font-size: 75%;">Inherit Password policy settings from the security domain.</mat-hint>
          </div>

          <div class="gv-form-section" *ngIf="!inherited">
            <mat-form-field appearance="outline" floatLabel="always">
              <mat-label>Minimum length</mat-label>
              <mat-select [(value)]="minLength" (selectionChange)="formChange()">
                <mat-option *ngFor="let p of [1,2,3,4,5,6,7,8,9,10,11,12]" [value]=p>{{p}}</mat-option>
              </mat-select>
              <mat-hint>Minimum length of the passwords. Passwords shorter than 8 characters are considered to be weak (OWASP recommendation).</mat-hint>
            </mat-form-field>

            <mat-form-field appearance="outline" floatLabel="always" style="margin-top: 5px;">
              <mat-label>Max consecutive letters</mat-label>
              <mat-select [(value)]="maxConsecutiveLetters" (selectionChange)="formChange()">
                <mat-option [value]="null">Unlimited</mat-option>
                <mat-option *ngFor="let p of [1,2,3,4,5]" [value]=p>{{p}}</mat-option>
              </mat-select>
              <mat-hint>Max number of consecutive letters.</mat-hint>
            </mat-form-field>

            <div fxLayout="column" style="margin-top: 5px;">
              <mat-slide-toggle [checked]="includeNumbers" (change)="setIncludeNumbers($event);formChange()">
                Include numbers
              </mat-slide-toggle>
              <mat-hint style="font-size: 75%;">Must include numbers.</mat-hint>
            </div>

            <div fxLayout="column" style="margin-top: 5px;">
              <mat-slide-toggle [checked]="includeSpecialCharacters" (change)="setIncludeSpecialCharacters($event);formChange()">
                Include special characters
              </mat-slide-toggle>
              <mat-hint style="font-size: 75%;">Must include special characters.</mat-hint>
            </div>

            <div fxLayout="column" style="margin-top: 5px;">
              <mat-slide-toggle [checked]="lettersInMixedCase" (change)="setLettersInMixedValue($event);formChange()">
                Letters in mixed case
              </mat-slide-toggle>
              <mat-hint style="font-size: 75%;">Must include letters in mixed case.</mat-hint>
            </div>
          </div>

          <div fxLayout="row">
            <button mat-raised-button [disabled]="(!applicationForm.valid || applicationForm.pristine) && !formChanged" type="submit">
              SAVE
            </button>
          </div>
        </div>
      </form>
    </div>
    <div class="gv-page-description" fxFlex>
      <h3>Password policy</h3>
      <div class="gv-page-description-content">
        <p>
          Update password criteria.
        </p>
      </div>
    </div>
  </div>
</div>
