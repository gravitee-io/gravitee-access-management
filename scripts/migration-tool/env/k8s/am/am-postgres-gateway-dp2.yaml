# Gateway dp2 (PostgreSQL). Release: am-gateway-dp2. Port-forward: 8092.
labels:
  environment: migration-test
  part-of: am-migration-tool

management:
  type: jdbc
oauth2:
  type: jdbc
gateway:
  type: jdbc

jdbc:
  driver: postgresql
  host: postgres-postgresql
  port: 5432
  database: gravitee-am
  username: gravitee
  password: gravitee-password
  drivers:
    - https://repo1.maven.org/maven2/org/postgresql/postgresql/42.7.3/postgresql-42.7.3.jar
    - https://repo1.maven.org/maven2/org/postgresql/r2dbc-postgresql/1.0.7.RELEASE/r2dbc-postgresql-1.0.7.RELEASE.jar

gatewayEnv: &gatewayEnv
  - name: gravitee_repositories_system_cluster
    value: gateway
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_TYPE
    value: jdbc
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_JDBC_DRIVER
    value: postgresql
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_JDBC_HOST
    value: postgres-postgresql
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_JDBC_PORT
    value: "5432"
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_JDBC_DATABASE
    value: gravitee-am
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_JDBC_USERNAME
    value: gravitee
  - name: GRAVITEE_REPOSITORIES_MANAGEMENT_JDBC_PASSWORD
    value: gravitee-password
  - name: GRAVITEE_REPOSITORIES_GATEWAY_TYPE
    value: jdbc
  - name: gravitee_repositories_gateway_use_management_settings
    value: "false"
  - name: gravitee_repositories_gateway_dataPlane_id
    value: dp2
  - name: gravitee_repositories_gateway_dataPlane_url
    value: "http://localhost:8092"
  - name: GRAVITEE_REPOSITORIES_GATEWAY_JDBC_DRIVER
    value: postgresql
  - name: GRAVITEE_REPOSITORIES_GATEWAY_JDBC_HOST
    value: postgres-postgresql
  - name: GRAVITEE_REPOSITORIES_GATEWAY_JDBC_PORT
    value: "5432"
  - name: GRAVITEE_REPOSITORIES_GATEWAY_JDBC_DATABASE
    value: gravitee-am-dp2
  - name: GRAVITEE_REPOSITORIES_GATEWAY_JDBC_USERNAME
    value: gravitee
  - name: GRAVITEE_REPOSITORIES_GATEWAY_JDBC_PASSWORD
    value: gravitee-password
  - name: GRAVITEE_REPOSITORIES_OAUTH2_TYPE
    value: jdbc
  - name: gravitee_repositories_oauth2_use_management_settings
    value: "false"
  - name: gravitee_repositories_oauth2_use_gateway_settings
    value: "true"
  - name: GRAVITEE_REPOSITORIES_OAUTH2_JDBC_DRIVER
    value: postgresql
  - name: GRAVITEE_REPOSITORIES_OAUTH2_JDBC_HOST
    value: postgres-postgresql
  - name: GRAVITEE_REPOSITORIES_OAUTH2_JDBC_PORT
    value: "5432"
  - name: GRAVITEE_REPOSITORIES_OAUTH2_JDBC_DATABASE
    value: gravitee-am-dp2
  - name: GRAVITEE_REPOSITORIES_OAUTH2_JDBC_USERNAME
    value: gravitee
  - name: GRAVITEE_REPOSITORIES_OAUTH2_JDBC_PASSWORD
    value: gravitee-password
  - name: LIQUIBASE_ANALYTICS_ENABLED
    value: "false"

api:
  enabled: false

gateway:
  enabled: true
  replicaCount: 1
  services:
    sync:
      permissions: true
  image:
    repository: graviteeio/am-gateway
    tag: 4.10.0
    pullPolicy: IfNotPresent
  ingress:
    enabled: false
  env: *gatewayEnv

ui:
  enabled: false

license:
  accept: true
