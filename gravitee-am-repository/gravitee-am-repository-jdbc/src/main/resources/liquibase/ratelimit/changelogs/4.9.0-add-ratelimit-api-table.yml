databaseChangeLog:
  - changeSet:
      id: 4.9.0-add-ratelimit-api-table
      author: GraviteeSource Team
      changes:
        #############################
        # RateLimit API #
        ############################
        - createTable:
            tableName: ratelimit_api
            columns:
              - column: { name: key, type: nvarchar(255), constraints: { nullable: false } }
              - column: { name: counter, type: bigint, constraints: { nullable: false, defaultValue: 0 } }
              - column: { name: reset_time, type: bigint, constraints: { nullable: false } }
              - column: { name: rate_limit, type: bigint, constraints: { nullable: false } }
              - column: { name: subscription, type: nvarchar(255), constraints: { nullable: true } }

        - addPrimaryKey:
            constraintName: pk_ratelimit_api
            columnNames: key
            tableName: ratelimit_api

        - createIndex:
            columns:
              - column:
                  name: reset_time
            indexName: idx_ratelimit_api_reset_time
            tableName: ratelimit_api
            unique: false
